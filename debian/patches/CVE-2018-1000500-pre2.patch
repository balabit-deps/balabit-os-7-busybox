From dbe95682b4bf1192d2860646617f157e6c44f2d1 Mon Sep 17 00:00:00 2001
From: Denys Vlasenko <vda.linux@googlemail.com>
Date: Tue, 13 Nov 2018 12:00:19 +0100
Subject: wget: print "TLS certificate validation not implemented" only once on
 redirects

function                                             old     new   delta
spawn_ssl_client                                     209     219     +10

Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com>
---
 networking/wget.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

(limited to 'networking/wget.c')

--- a/networking/wget.c
+++ b/networking/wget.c
@@ -768,8 +768,10 @@ static void spawn_ssl_client(const char
 	int pid;
 	char *servername, *p;
 
-	if (!(option_mask32 & WGET_OPT_NO_CHECK_CERT))
+	if (!(option_mask32 & WGET_OPT_NO_CHECK_CERT)) {
 		bb_error_msg("note: TLS certificate validation not implemented");
+		option_mask32 |= WGET_OPT_NO_CHECK_CERT;
+	}
 
 	servername = xstrdup(host);
 	p = strrchr(servername, ':');
